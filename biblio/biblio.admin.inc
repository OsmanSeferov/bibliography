<?php

/**
 * Settings form
 * @return type
 */
function biblio_settings_form() {

  $form['main'] = array(
    '#type' => 'fieldset',
    '#title' => t('Main settings'),
  );

  $lang_list = language_list();
  foreach ($lang_list as $key => $language) {
    $form['main']['biblio_' . $key . '_url_suffix'] = array(
      '#type' => 'textfield',
      '#title' => t('URL alias suffix for @language language', array('@language' => $language->name)),
      '#field_prefix' => '[node_path]/',
      '#description' => t('The URL alias suffix that will be used for autogenerated bibliography paths (like [article_path]/bibliography).'
          . '<br /><b>Note</b> that insternal path (node/[nid]/bibliography) will not be changed, only aliases. And you need to update each article node for apply new aliases.'),
      '#default_value' => variable_get('biblio_' . $key . '_url_suffix', 'bibliography'),
    );
  }

  $form['taxonomy'] = array(
    '#type' => 'fieldset',
    '#title' => t('Taxonomy terms'),
  );
  $vocabularies = taxonomy_get_vocabularies();
  $options = array();
  foreach ($vocabularies as $vid => $vocabulary) {
    $options[$vid] = check_plain($vocabulary->name);
  }
  $form['taxonomy']['biblio_autocomplete_vocabularies'] = array(
    '#type' => 'checkboxes',
    '#title' => t('Vocabularies'),
    '#options' => $options,
    '#default_value' => variable_get('biblio_autocomplete_vocabularies', array()),
    '#description' => t('Select the vocabularies to be available as autocomplete suggestions.'),
  );
  $form['taxonomy']['footnote_limit'] = array(
    '#type' => 'select',
    '#title' => t('Number of suggestions'),
    '#description' => t('The maximum number of suggestions to display on autocomplete.'),
    '#options' => drupal_map_assoc(array(2, 4, 8, 16, 32)),
    '#default_value' => variable_get('footnote_limit', 2),
  );

  return system_settings_form($form);
}
